# ID设置自动测试工装系统 - 需求文档

## 1. 项目概述

### 1.1 项目背景
开发一套自动化ID设置测试工装系统，用于模块生产过程中的ID烧录和测试验证，支持6-12个模块并行处理，提高生产效率和质量控制水平。

### 1.2 项目目标
- 实现模块ID设置的自动化测试流程
- 支持6-12个模块并行处理
- 提供实时监控和结果反馈
- 确保数据准确性和系统可靠性

## 2. 功能需求

### 2.1 条码扫描功能
- **需求描述**: 通过串口读取扫描枪条码数据
- **功能要求**:
  - 支持6-12个USB串口扫码枪同时工作
  - 实时读取条码数据并绑定设备号
  - 数据缓存支持快速查询和比对
  - 异常条码处理和重试机制

### 2.2 PLC通信功能
- **需求描述**: 与PLC设备进行TCP通信
- **功能要求**:
  - 接收PLC传输的JSON格式产品个数数据
  - 发送条码数量验证结果（OK/异常指令）
  - 接收PLC的开始指令
  - 支持心跳检测和自动重连

### 2.3 数据验证功能
- **需求描述**: 比对PLC产品个数与缓存条码数量
- **功能要求**:
  - 实时比对产品个数和条码数量
  - 数量相等时发送OK指令
  - 数量不匹配时发送异常指令
  - 支持多次验证和重试机制

### 2.4 烧录控制功能
- **需求描述**: 管理烧录指令下发和结果接收
- **功能要求**:
  - 向烧录设备发送烧录指令和多条条码信息
  - 接收烧录完成后的结果反馈
  - 支持批量烧录和单个模块烧录
  - 烧录超时和异常处理

### 2.5 结果处理功能
- **需求描述**: 处理烧录结果并保存到数据库
- **功能要求**:
  - 解析烧录设备返回的结果数据
  - 将结果保存到SQLite数据库
  - 生成烧录日志和统计报告
  - 支持结果查询和导出

### 2.6 EMS通信功能
- **需求描述**: 将最终结果反馈给EMS系统
- **功能要求**:
  - 通过TCP/IP与EMS系统通信
  - 发送格式化的烧录结果数据
  - 支持实时数据推送和批量传输
  - 通信异常处理和重试机制

## 3. 性能需求

### 3.1 处理能力
- 支持6-12个模块/批次并行处理
- 单批次处理时间：<5分钟
- 日均处理能力：≥1000个模块

### 3.2 响应时间
- 条码扫描响应：<100ms
- 数据验证响应：<50ms
- 指令传输响应：<200ms
- 结果反馈响应：<300ms

### 3.3 可靠性要求
- 系统可用性：≥99.9%
- 数据准确性：100%
- 故障恢复时间：<5分钟
- 通信中断重连：<10秒

## 4. 接口需求

### 4.1 硬件接口
- **串口接口**: RS232，支持6-12个扫描枪
- **网络接口**: TCP/IP，与PLC、烧录设备、EMS系统通信
- **USB接口**: 支持外接设备连接

### 4.2 软件接口
- **PLC接口**: JSON格式产品个数数据
- **烧录设备接口**: 烧录指令和结果数据
- **EMS系统接口**: 最终结果数据格式
- **数据库接口**: SQLite嵌入式数据库

### 4.3 数据格式
**PLC产品个数数据格式**:
```json
{"product_count": 6}
```

**烧录指令格式**:
```json
{
  "command": "program",
  "barcodes": [
    {"device_id": "01", "barcode": "4C5A0000DE45"},
    {"device_id": "02", "barcode": "4C5A0000DE46"}
  ]
}
```

**烧录结果格式**:
```json
{
  "status": "success",
  "results": [
    {"device_id": "01", "barcode": "4C5A0000DE45", "result": true},
    {"device_id": "02", "barcode": "4C5A0000DE46", "result": false}
  ]
}
```

## 5. 安全需求

### 5.1 数据安全
- 条码数据加密存储
- 通信数据SSL加密
- 数据库访问权限控制
- 操作日志完整记录

### 5.2 系统安全
- 防止未授权访问
- 异常操作告警
- 系统资源监控
- 自动备份和恢复

## 6. 兼容性需求

### 6.1 操作系统兼容性
- Windows 10/11
- Linux Ubuntu 18.04+

### 6.2 硬件兼容性
- 支持主流品牌扫描枪
- 兼容标准PLC设备
- 适配常见烧录设备
- 支持多种串口服务器

## 7. 维护需求

### 7.1 系统维护
- 配置参数可视化调整
- 日志文件自动管理
- 系统状态实时监控
- 远程维护和支持

### 7.2 数据维护
- 数据库定期备份
- 历史数据清理策略
- 统计报表生成
- 数据导出功能

## 8. 部署需求

### 8.1 单机部署
- Java 8+运行环境
- SQLite嵌入式数据库
- 网络端口配置
- 串口设备配置

### 8.2 生产环境
- 高可用部署方案
- 负载均衡配置
- 监控告警系统
- 灾难恢复机制

---

*文档版本: V1.0*
*更新日期: 2025-09-10*